package com.example.konttragenty;
import java.sql.*; import java.util.*; import java.io.InputStream; import java.util.Properties;
public class PersonDAO { private Connection getConnection() throws SQLException { Properties props=new Properties(); try(InputStream in=getClass().getClassLoader().getResourceAsStream("application.properties")){props.load(in);}catch(Exception e){throw new SQLException(e);} return DriverManager.getConnection(props.getProperty("db.url"),props.getProperty("db.username"),props.getProperty("db.password"));} public List<Person> getAll() throws SQLException { List<Person> list=new ArrayList<>(); try(Connection c=getConnection(); Statement s=c.createStatement(); ResultSet rs=s.executeQuery("SELECT id, name_full as name FROM portal.person")){ while(rs.next()){ Person p=new Person(); p.setId(rs.getInt("id")); p.setName(rs.getString("name")); list.add(p);} } return list;} public void updateField(int id,String field,String value)throws SQLException{ String sql="UPDATE portal.person SET "+field+"=? WHERE id=?"; try(Connection c=getConnection(); PreparedStatement ps=c.prepareStatement(sql)){ps.setString(1,value);ps.setInt(2,id);ps.executeUpdate();}}}